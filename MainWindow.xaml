<Window x:Class="ImageConverterPlus.MainWindow"
        x:Name="MainWindowWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:ImageConverterPlus"
        xmlns:views="clr-namespace:ImageConverterPlus.Views"
        xmlns:vm="clr-namespace:ImageConverterPlus.ViewModels"
        xmlns:controls="clr-namespace:ImageConverterPlus.Controls"
        xmlns:fw="clr-namespace:SourceChord.FluentWPF;assembly=FluentWPF"
        xmlns:drawing="clr-namespace:System.Drawing;assembly=System.Drawing.Common"
        xmlns:sys="clr-namespace:System;assembly=System.Runtime"
        xmlns:behaviors="clr-namespace:ImageConverterPlus.Behaviors"
        xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
        mc:Ignorable="d"
        Title="SE Image Converter+"
        Height="450"
        Width="750"
        BorderThickness="0.5"
        BorderBrush="#404040"
            fw:AcrylicWindow.Enabled="True"
            fw:AcrylicWindow.NoiseOpacity="0"
            fw:AcrylicWindow.AcrylicAccentState="BlurBehind"
            fw:AcrylicWindow.TintOpacity="0"
            fw:AcrylicWindow.FallbackColor="Transparent"
            fw:AcrylicWindow.AcrylicWindowStyle="None"
        ResizeMode="CanMinimize"
        AllowsTransparency="True"
        WindowStyle="None"
        ContextMenuService.IsEnabled="False"
        RenderOptions.BitmapScalingMode="HighQuality">

    <WindowChrome.WindowChrome>
        <WindowChrome CaptionHeight="32" />
    </WindowChrome.WindowChrome>

    <Window.Resources>
        <Style x:Key="LCDSizeTextBox" TargetType="controls:ScrollablePositiveIntegerTextBox">
            <Setter Property="Minimum" Value="1" />
            <Setter Property="Maximum" Value="999" />
            <Setter Property="ScrollChange" Value="1" />
            <Setter Property="Width" Value="45" />
            <Setter Property="Height" Value="20" />
            <Setter Property="Foreground" Value="DarkGray" />
            <Setter Property="Background" Value="#25303030" />
            <Setter Property="BorderBrush" Value="#505050" />
            <Setter Property="VerticalContentAlignment" Value="Center" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding SelectedLCD}" Value="Custom">
                    <Setter Property="Foreground" Value="White" />
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="LCDPresetButton" TargetType="Button" BasedOn="{StaticResource TransparentRoundedButtonSmall}">
            <Setter Property="Height" Value="25" />
            <Setter Property="Margin" Value="0,5,0,0" />
        </Style>
    </Window.Resources>

    <Window.DataContext>
        <vm:MainWindowViewModel />
    </Window.DataContext>

    <DockPanel>
        <views:WindowTitleBar DockPanel.Dock="Top" Height="32"
                              Foreground="White">
            <views:WindowTitleBar.Style>
                <Style TargetType="views:WindowTitleBar">
                    <Setter Property="Background" Value="#e6444444" />
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding IsActive, RelativeSource={RelativeSource AncestorType=Window}}" Value="False">
                            <Setter Property="Background" Value="#cd444444" />
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </views:WindowTitleBar.Style>
        </views:WindowTitleBar>
        
        <Grid>
            <Grid.Style>
                <Style TargetType="Grid">
                    <Setter Property="Background" Value="#e6202020" />
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding IsActive, RelativeSource={RelativeSource AncestorType=Window}}" Value="False">
                            <Setter Property="Background" Value="#cd202020" />
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Grid.Style>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="10" />
                <ColumnDefinition Width="165" />
                <ColumnDefinition Width="165" />
                <ColumnDefinition Width="410" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="0" />
                <RowDefinition Height="54" />
                <RowDefinition Height="300" />
                <RowDefinition Height="64" />
            </Grid.RowDefinitions>

            <!--Title Bar-->
            <!--<StackPanel Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="4" FlowDirection="LeftToRight" Orientation="Horizontal">
                <Image x:Name="AppTitleIcon" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="8,0,3,0" Height="16" Width="16" Source="/icon16.png" Stretch="Uniform"
                       IsHitTestVisible="True" WindowChrome.IsHitTestVisibleInChrome="True" MouseLeftButtonDown="AppTitleIcon_MouseLeftButtonChanged" 
                       MouseLeftButtonUp="AppTitleIcon_MouseLeftButtonChanged" LostMouseCapture="AppTitleIcon_LostMouseCapture">
                    <Image.ContextMenu>
                        <ContextMenu Style="{StaticResource CustomMenu}">
                            <MenuItem Style="{StaticResource CustomMenuItem}"
                                      Header="Open Log"
                                      Command="{Binding OpenLogsCommand}">
                                <MenuItem.ToolTip>
                                    <ToolTip Style="{StaticResource CustomToolTip}" x:Name="OpenLogBtnToolTip" />
                                </MenuItem.ToolTip>
                            </MenuItem>
                            <MenuItem Style="{StaticResource CustomMenuItem}" Header="App Directory" Click="OpenAppDirBtn_Click" x:Name="OpenAppDirBtn"
                                      ToolTip="Open this application's base directory in File Explorer.">
                            </MenuItem>
                        </ContextMenu>
                    </Image.ContextMenu>
                </Image>
            </StackPanel>-->

            <!--big title-->
            <Label x:Name="AppBigTitle" Content="SE Image Converter+" HorizontalAlignment="Center" VerticalAlignment="Bottom" FontSize="23" 
                   Grid.Column="1" Grid.Row="1" Grid.ColumnSpan="2" Foreground="White" />

            <!--Background Color Rectangle-->
            <Rectangle Grid.Row="1" Grid.Column="3" Grid.RowSpan="4" x:Name="ImagePreviewBackground" Fill="#101010" 
                       Height="350" Width="350" HorizontalAlignment="Center" VerticalAlignment="Center" Opacity="0.25"
                       AllowDrop="True" PreviewDrop="Preview_PreviewDrop"
                       ToolTip="Converted Image Preview">
                <Rectangle.ContextMenu>
                    <ContextMenu Style="{StaticResource CustomMenu}">
                        <MenuItem Style="{StaticResource CustomMenuItem}"
                                  Header="Convert From Clipboard" Click="PasteFromClipboard"
                                  ToolTip="If the clipboard contains an image,&#x0a;converts it with currently selected settings">
                        </MenuItem>
                    </ContextMenu>
                </Rectangle.ContextMenu>
            </Rectangle>
            <!--Image Preview-->
            <TextBlock x:Name="ImagePreviewTextBlock" Text="Image Preview" Grid.Row="5" Grid.Column="3" Grid.RowSpan="2" Foreground="White"
                       HorizontalAlignment="Center" VerticalAlignment="Bottom" Height="30" Margin="0,0,0,30" FontSize="15" />
            <Border Grid.Row="1" Grid.Column="3" Grid.RowSpan="4" x:Name="ImagePreviewBorder" Background="Black" Visibility="Hidden"
                    Height="350" Width="350" HorizontalAlignment="Center" VerticalAlignment="Center"
                    PreviewDrop="Preview_PreviewDrop" ClipToBounds="True" AllowDrop="True">
                <Border.ContextMenu>
                    <ContextMenu Style="{StaticResource CustomMenu}">
                        <MenuItem Style="{StaticResource CustomMenuItem}" Header="Copy to Clipboard"
                                  Command="{Binding CopyImageToClipboardCommand}" />
                        <MenuItem Style="{StaticResource CustomMenuItem}" Header="Convert From Clipboard"
                                  Click="PasteFromClipboard" /> 
                        <MenuItem Style="{StaticResource CustomMenuItem}" Header="Reset Zoom &amp; Pan"
                                  Command="{Binding ResetZoomAndPanCommand}" />
                        <MenuItem Style="{StaticResource CustomMenuItem}" Header="Remove" Click="RemovePreview"
                                  IsEnabled="{Binding InstantChanges,Converter={StaticResource BooleanInverter}}"/>
                    </ContextMenu>
                </Border.ContextMenu>
                <Grid>
                    <Image HorizontalAlignment="Center" VerticalAlignment="Center" x:Name="ImagePreview" />
                    <StackPanel Grid.Row="1" Grid.Column="3" Grid.RowSpan="4" Orientation="Horizontal"
                                HorizontalAlignment="Center" VerticalAlignment="Center" x:Name="PreviewGrid"
                                PreviewDrop="Preview_PreviewDrop" AllowDrop="True"
                                Visibility="{Binding ShowPreviewGrid,Converter={StaticResource BooleanToVisibilityConverter}}" />
                </Grid>
            </Border>

            <!--Menu-->
            <ScrollViewer Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="2"
                          behaviors:ScrollAnimationBehavior.IsEnabled="True"
                          behaviors:ScrollAnimationBehavior.TimeDuration="00:00:00.10"
                          behaviors:ScrollAnimationBehavior.PointsToScroll="40" 
                          FocusVisualStyle="{x:Null}" Margin="0,0,-5,0"
                          VerticalScrollBarVisibility="Auto" CanContentScroll="True">
                <Grid Margin="0,0,5,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <!-- column 1-->
                    <!--Cool buttons from Dopamine player-->
                    <StackPanel Grid.Column="0" Width="145" Margin="0,5" >
                        <Button Style="{StaticResource TransparentRoundedButton}" Content="Browse Files" Margin="0,5,0,5" 
                                x:Name="BrowseFilesBtn" Height="40" FontSize="15" Command="{Binding BrowseFilesCommand}">
                            <Button.ToolTip>
                                <ToolTip Style="{StaticResource CustomToolTip}" x:Name="BrowseFilesToolTip" Content="Browse local Files" FontSize="12" />
                            </Button.ToolTip>
                        </Button>
                        <Grid Height="25" Margin="5,5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <ToggleButton Style="{StaticResource TransparentRoundedToggleButtonSmall}"
                                          Content="3 Bit" Grid.Column="0" Width="64" Height="25" HorizontalAlignment="Left"
                                          FontSize="12" x:Name="ToggleBtn_3BitColor" Click="ColorDepthOption_Clicked"
                                          ToolTip="Works with &quot;Monospace&quot; font.&#x0a;Use this for vanilla SE">
                            </ToggleButton>
                            <ToggleButton Style="{StaticResource TransparentRoundedToggleButtonSmall}"
                                          Content="5 Bit" Grid.Column="1" Width="64" Height="25" HorizontalAlignment="Right"
                                          FontSize="12" x:Name="ToggleBtn_5BitColor" Click="ColorDepthOption_Clicked"
                                          ToolTip="Requires the &quot;Mono Color&quot; mod and &quot;Mono Color&quot; font">
                            </ToggleButton>
                        </Grid>
                        <ToggleButton Style="{StaticResource TransparentRoundedToggleButtonSmall}"
                                      Content="Dithering" Margin="5,5" Height="25"
                                      FontSize="12" IsChecked="{Binding EnableDithering}"
                                      ToolTip="Applies Floyd-Steinberg error diffusion during conversion.&#x0a;Helps with color banding issues.">
                        </ToggleButton>
                        <Grid Margin="5">
                            <Border Background="#05FFFFFF" CornerRadius="4" />
                            <Label Margin="0,2" Content="Scaling Modes" Foreground="White" HorizontalContentAlignment="Center" VerticalAlignment="Top" />
                            <StackPanel Margin="0,30,0,0">
                                <ToggleButton Style="{StaticResource TransparentRoundedToggleButtonSmall}" x:Name="ToggleBtn_ScaleNearest"
                                              Content="Nearest" Height="25" Width="125" Margin="0,3,0,3" Click="ScaleOption_Clicked"
                                              ToolTip="&apos;Lowest quality&apos;. Leaves jagged edges.&#x0a;May be better for extremely low resolution images">
                                </ToggleButton>
                                <ToggleButton Style="{StaticResource TransparentRoundedToggleButtonSmall}" x:Name="ToggleBtn_ScaleBilinear"
                                              Content="Bilinear" Height="25" Width="125" Margin="0,2,0,3" Click="ScaleOption_Clicked" />
                                <ToggleButton Style="{StaticResource TransparentRoundedToggleButtonSmall}" x:Name="ToggleBtn_ScaleBicubic"
                                              Content="Bicubic" Height="25" Width="125" Margin="0,2,0,5" Click="ScaleOption_Clicked"
                                              ToolTip="&apos;Highest quality&apos;">
                                </ToggleButton>
                            </StackPanel>
                        </Grid>
                        <Grid Margin="5">
                            <Border Background="#05FFFFFF" CornerRadius="4" />
                            <StackPanel>
                                <Label Margin="0,2,0,0" Grid.ColumnSpan="2" Content="Image Controls" Foreground="White" HorizontalContentAlignment="Center" VerticalAlignment="Top" />
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <Button Style="{StaticResource TransparentRoundedButtonSmall}" Width="38" Height="30" 
                                            FontSize="15" Content="⮁" Margin="0,5,0,5"
                                            Command="{Binding ImageTransformCommand}"
                                            CommandParameter="{x:Static drawing:RotateFlipType.RotateNoneFlipY}"
                                            ToolTip="Flip Vertically">
                                    </Button>
                                    <Button Style="{StaticResource TransparentRoundedButtonSmall}" Width="38" Height="30" FontSize="15" 
                                            Content="⮂" Margin="3,5,3,5"
                                            Command="{Binding ImageTransformCommand}"
                                            CommandParameter="{x:Static drawing:RotateFlipType.RotateNoneFlipX}"
                                            ToolTip="Flip Horizontally">
                                    </Button>
                                    <Button Style="{StaticResource TransparentRoundedButtonSmall}" 
                                            Width="38" Height="30" FontSize="15" Content="⭮" 
                                            Margin="0,5,0,5"
                                            Command="{Binding ImageTransformCommand}"
                                            CommandParameter="{x:Static drawing:RotateFlipType.Rotate90FlipNone}"
                                            ToolTip="Rotate 90°">
                                    </Button>
                                </StackPanel>
                                <Button Style="{StaticResource TransparentRoundedButtonSmall}"
                                        Width="125" Height="25"
                                        Margin="0,0,0,5" Content="Zoom to Fit"
                                        Command="{Binding ZoomToFitCommand}" />
                                <Button Style="{StaticResource TransparentRoundedButtonSmall}"
                                        Width="125" Height="25"
                                        Margin="0,0,0,5" Content="Zoom to Fill"
                                        Command="{Binding ZoomToFillCommand}" />
                                <Button Style="{StaticResource TransparentRoundedButtonSmall}"
                                        Width="125" Height="25"
                                        Margin="0,0,0,5" Content="Reset Zoom &amp; Pan"
                                        Command="{Binding ResetZoomAndPanCommand}" />
                            </StackPanel>
                        </Grid>
                    </StackPanel>

                    <!--Column 2-->
                    <StackPanel Grid.Column="2" Width="145" Margin="0,5">
                        <ToggleButton Style="{StaticResource TransparentRoundedToggleButtonSmall}"
                                      Content="Instant Mode" Margin="5,20,5,0"
                                      Height="25" IsChecked="{Binding InstantChanges}"
                                      ToolTip="Apply Changes Instantly">
                        </ToggleButton>

                        <!--LCD Size Controls-->
                        <StackPanel Margin="5,9,5,5">
                            <Border Background="#05ffffff" CornerRadius="4" Margin="0,0,0,5">
                                <StackPanel>
                                    <TextBlock Text="Custom LCD Size" Foreground="White" TextAlignment="Center" Margin="0,7,0,0"/>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center"
                                                Margin="0,9.5,0,8.5">
                                        <!--Width Input-->
                                        <controls:ScrollablePositiveIntegerTextBox Style="{DynamicResource LCDSizeTextBox}" Value="{Binding LCDWidth}">
                                            <i:Interaction.Triggers>
                                                <i:EventTrigger EventName="ValueChanged">
                                                    <i:ChangePropertyAction TargetObject="{Binding}" PropertyName="SelectedLCD" Value="Custom" />
                                                </i:EventTrigger>
                                            </i:Interaction.Triggers>
                                        </controls:ScrollablePositiveIntegerTextBox>
                                        <TextBlock Text="x" Foreground="DarkGray" Padding="8.5,1.5,8.5,0" />
                                        <!--Height Input-->
                                        <controls:ScrollablePositiveIntegerTextBox Style="{DynamicResource LCDSizeTextBox}" Value="{Binding LCDHeight}">
                                            <i:Interaction.Triggers>
                                                <i:EventTrigger EventName="ValueChanged">
                                                    <i:ChangePropertyAction TargetObject="{Binding}" PropertyName="SelectedLCD" Value="Custom" />
                                                </i:EventTrigger>
                                            </i:Interaction.Triggers>
                                        </controls:ScrollablePositiveIntegerTextBox>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                            <!--LCD Panel-->
                            <Button Content="LCD Panel" ToolTip="178x178">
                                <i:Interaction.Triggers>
                                    <i:EventTrigger EventName="Click">
                                        <i:ChangePropertyAction TargetObject="{Binding}" PropertyName="LCDWidth" Value="178" />
                                        <i:ChangePropertyAction TargetObject="{Binding}" PropertyName="LCDHeight" Value="178" />
                                        <i:ChangePropertyAction TargetObject="{Binding}" PropertyName="SelectedLCD" Value="LCDPanel" />
                                    </i:EventTrigger>
                                </i:Interaction.Triggers>
                                <Button.Style>
                                    <Style TargetType="Button" BasedOn="{StaticResource LCDPresetButton}">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding SelectedLCD}" Value="LCDPanel">
                                                <Setter Property="Background" Value="#10F0F0F0" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>
                            <!--Text Panel-->
                            <Button Content="Text Panel" ToolTip="178x107">
                                <i:Interaction.Triggers>
                                    <i:EventTrigger EventName="Click">
                                        <i:ChangePropertyAction TargetObject="{Binding}" PropertyName="LCDWidth" Value="178" />
                                        <i:ChangePropertyAction TargetObject="{Binding}" PropertyName="LCDHeight" Value="107" />
                                        <i:ChangePropertyAction TargetObject="{Binding}" PropertyName="SelectedLCD" Value="TextPanel" />
                                    </i:EventTrigger>
                                </i:Interaction.Triggers>
                                <Button.Style>
                                    <Style TargetType="Button" BasedOn="{StaticResource LCDPresetButton}">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding SelectedLCD}" Value="TextPanel">
                                                <Setter Property="Background" Value="#10F0F0F0" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>
                            <!--Wide LCD Panel (Wide)-->
                            <Button Content="Wide LCD Panel (Wide)" ToolTip="356x178">
                                <i:Interaction.Triggers>
                                    <i:EventTrigger EventName="Click">
                                        <i:ChangePropertyAction TargetObject="{Binding}" PropertyName="LCDWidth" Value="356" />
                                        <i:ChangePropertyAction TargetObject="{Binding}" PropertyName="LCDHeight" Value="178" />
                                        <i:ChangePropertyAction TargetObject="{Binding}" PropertyName="SelectedLCD" Value="WideLCDPanel" />
                                    </i:EventTrigger>
                                </i:Interaction.Triggers>
                                <Button.Style>
                                    <Style TargetType="Button" BasedOn="{StaticResource LCDPresetButton}">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding SelectedLCD}" Value="WideLCDPanel">
                                                <Setter Property="Background" Value="#10F0F0F0" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>
                            <!--Wide LCD Panel (Tall)-->
                            <Button Content="Wide LCD Panel (Tall)" ToolTip="178x356">
                                <i:Interaction.Triggers>
                                    <i:EventTrigger EventName="Click">
                                        <i:ChangePropertyAction TargetObject="{Binding}" PropertyName="LCDWidth" Value="178" />
                                        <i:ChangePropertyAction TargetObject="{Binding}" PropertyName="LCDHeight" Value="356" />
                                        <i:ChangePropertyAction TargetObject="{Binding}" PropertyName="SelectedLCD" Value="WideLCDPanelTall" />
                                    </i:EventTrigger>
                                </i:Interaction.Triggers>
                                <Button.Style>
                                    <Style TargetType="Button" BasedOn="{StaticResource LCDPresetButton}">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding SelectedLCD}" Value="WideLCDPanelTall">
                                                <Setter Property="Background" Value="#10F0F0F0" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>
                        </StackPanel>
                        <!--Image Split Controls-->
                        <Grid Height="100" Margin="5,5,5,5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="30" />
                                <RowDefinition Height="30" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Border Background="#05FFFFFF" Grid.ColumnSpan="3" Grid.RowSpan="3" CornerRadius="4" BorderThickness="0" />
                            <controls:ScrollablePositiveIntegerTextBox
                                Background="#25303030" Grid.Column="0" Grid.Row="1" Margin="0,2,0,0" Text="1"
                                VerticalAlignment="Top" VerticalContentAlignment="Center" BorderBrush="#505050" Foreground="White"
                                Height="20" Width="35" HorizontalAlignment="Center"
                                ContextMenu="{x:Null}"
                                MouseEnter="MenuTextBox_MouseEnteredOrLeft" MouseLeave="MenuTextBox_MouseEnteredOrLeft"
                                Value="{Binding ImageSplitWidth}"
                                Minimum="1" Maximum="9" ScrollChange="1"
                                ToolTip="Width">
                            </controls:ScrollablePositiveIntegerTextBox>
                            <Label Grid.ColumnSpan="2" Content="Split Image" Foreground="White" HorizontalContentAlignment="Center" VerticalAlignment="Center" />
                            <Label Content="by" Foreground="DarkGray" HorizontalAlignment="Center" Grid.Row="1" Grid.ColumnSpan="2" Margin="0,0,0,7" VerticalAlignment="Bottom" Height="25"/>
                            <controls:ScrollablePositiveIntegerTextBox
                                Background="#25303030" Grid.Column="1" Grid.Row="1" Margin="0,2,0,0" Text="1"
                                VerticalAlignment="Top" VerticalContentAlignment="Center" BorderBrush="#505050" Foreground="White"
                                Height="20" Width="35" HorizontalAlignment="Center"
                                ContextMenu="{x:Null}"
                                MouseEnter="MenuTextBox_MouseEnteredOrLeft" MouseLeave="MenuTextBox_MouseEnteredOrLeft"
                                Value="{Binding ImageSplitHeight}"
                                Minimum="1" Maximum="9" ScrollChange="1"
                                ToolTip="Height">
                            </controls:ScrollablePositiveIntegerTextBox>
                            <ToggleButton Style="{StaticResource TransparentRoundedToggleButtonSmall}"
                                          Content="Show Grid" Margin="0,0,0,5" Height="25" Width="125" Grid.Row="2" Grid.ColumnSpan="2"
                                          FontSize="12" IsChecked="{Binding ShowPreviewGrid}"
                                          ToolTip="Show the split squares to copy.">
                            </ToggleButton>
                        </Grid>
                    </StackPanel>
                </Grid>
            </ScrollViewer>

            <Button Style="{StaticResource TransparentRoundedButton}" x:Name="ConvertBtn"
                    Content="Convert" Grid.Row="4" Grid.Column="1" Margin="0,5,0,0"
                    Width="145" Height="40" FontSize="15" VerticalAlignment="Top"
                    Command="{Binding ConvertImageCommand}">
                <Button.ToolTip>
                    <ToolTip Style="{StaticResource CustomToolTip}" Content="" x:Name="ConvertBtnToolTip" />
                </Button.ToolTip>
            </Button>

            <Button Style="{StaticResource TransparentRoundedButton}" x:Name="CopyToClipBtn"
                    Content="Copy to Clipboard" Grid.Row="4" Grid.Column="2" Margin="0,5,0,0"
                    Width="145" Height="40" FontSize="15" VerticalAlignment="Top"
                    Command="{Binding CopyImageToClipboardCommand}">
            </Button>
        </Grid>
    </DockPanel>
</Window>

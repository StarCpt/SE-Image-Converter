<Window x:Class="ImageConverterPlus.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:ImageConverterPlus"
        xmlns:views="clr-namespace:ImageConverterPlus.Views"
        xmlns:vm="clr-namespace:ImageConverterPlus.ViewModels"
        xmlns:controls="clr-namespace:ImageConverterPlus.Controls"
        xmlns:fw="clr-namespace:SourceChord.FluentWPF;assembly=FluentWPF"
        xmlns:drawing="clr-namespace:System.Drawing;assembly=System.Drawing.Common"
        xmlns:sys="clr-namespace:System;assembly=System.Runtime"
        xmlns:behaviors="clr-namespace:ImageConverterPlus.Behaviors"
        xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
        mc:Ignorable="d"
        Title="SE Image Converter+"
        Height="450"
        Width="750"
        MinHeight="450"
        MinWidth="750"
        BorderThickness="0.5"
        BorderBrush="#404040"
            fw:AcrylicWindow.Enabled="True"
            fw:AcrylicWindow.NoiseOpacity="0"
            fw:AcrylicWindow.AcrylicAccentState="BlurBehind"
            fw:AcrylicWindow.TintOpacity="0"
            fw:AcrylicWindow.FallbackColor="Transparent"
            fw:AcrylicWindow.AcrylicWindowStyle="None"
        ResizeMode="CanResize"
        AllowsTransparency="True"
        WindowStyle="None"
        ContextMenuService.IsEnabled="False"
        RenderOptions.BitmapScalingMode="HighQuality">

    <WindowChrome.WindowChrome>
        <WindowChrome CaptionHeight="32" />
    </WindowChrome.WindowChrome>

    <Window.Resources>
        
    </Window.Resources>

    <Window.DataContext>
        <vm:MainWindowViewModel />
    </Window.DataContext>

    <DockPanel>
        <views:WindowTitleBar DockPanel.Dock="Top" Height="32" Foreground="White">
            <views:WindowTitleBar.Style>
                <Style TargetType="views:WindowTitleBar">
                    <Setter Property="Background" Value="#e6444444" />
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding IsActive, RelativeSource={RelativeSource AncestorType=Window}}" Value="False">
                            <Setter Property="Background" Value="#cd444444" />
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </views:WindowTitleBar.Style>
        </views:WindowTitleBar>
        
        <Grid>
            <Grid.Style>
                <Style TargetType="Grid">
                    <Setter Property="Background" Value="#e6202020" />
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding IsActive, RelativeSource={RelativeSource AncestorType=Window}}" Value="False">
                            <Setter Property="Background" Value="#cd202020" />
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Grid.Style>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="10" />
                <ColumnDefinition Width="165" />
                <ColumnDefinition Width="165" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="0" />
                <RowDefinition Height="54" />
                <RowDefinition Height="*" />
                <RowDefinition Height="64" />
            </Grid.RowDefinitions>

            <!--Title Bar-->
            <!--<StackPanel Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="4" FlowDirection="LeftToRight" Orientation="Horizontal">
                <Image x:Name="AppTitleIcon" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="8,0,3,0" Height="16" Width="16" Source="/icon16.png" Stretch="Uniform"
                       IsHitTestVisible="True" WindowChrome.IsHitTestVisibleInChrome="True" MouseLeftButtonDown="AppTitleIcon_MouseLeftButtonChanged" 
                       MouseLeftButtonUp="AppTitleIcon_MouseLeftButtonChanged" LostMouseCapture="AppTitleIcon_LostMouseCapture">
                    <Image.ContextMenu>
                        <ContextMenu Style="{StaticResource CustomMenu}">
                            <MenuItem Style="{StaticResource CustomMenuItem}"
                                      Header="Open Log"
                                      Command="{Binding OpenLogsCommand}">
                                <MenuItem.ToolTip>
                                    <ToolTip Style="{StaticResource CustomToolTip}" x:Name="OpenLogBtnToolTip" />
                                </MenuItem.ToolTip>
                            </MenuItem>
                            <MenuItem Style="{StaticResource CustomMenuItem}" Header="App Directory" Click="OpenAppDirBtn_Click" x:Name="OpenAppDirBtn"
                                      ToolTip="Open this application's base directory in File Explorer.">
                            </MenuItem>
                        </ContextMenu>
                    </Image.ContextMenu>
                </Image>
            </StackPanel>-->

            <!--big title-->
            <Label x:Name="AppBigTitle" Content="SE Image Converter+" HorizontalAlignment="Center" VerticalAlignment="Bottom" FontSize="23" 
                   Grid.Column="1" Grid.Row="1" Grid.ColumnSpan="2" Foreground="White" />

            <!--Background Color Rectangle-->
            <Grid Grid.Row="1" Grid.Column="3" Grid.RowSpan="4">
                <Rectangle Grid.Row="1" Grid.Column="3" Grid.RowSpan="4" x:Name="ImagePreviewBackground" Fill="#101010" 
                       HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Opacity="0.25"
                       Width="350" Height="350"
                       AllowDrop="True" PreviewDrop="Preview_PreviewDrop" Margin="29.5,33.5" Stretch="Uniform"
                       ToolTip="Converted Image Preview">
                    <Rectangle.ContextMenu>
                        <ContextMenu Style="{StaticResource CustomMenu}">
                            <MenuItem Style="{StaticResource CustomMenuItem}"
                                  Header="Convert From Clipboard" Click="PasteFromClipboard"
                                  ToolTip="If the clipboard contains an image,&#x0a;converts it with currently selected settings">
                            </MenuItem>
                        </ContextMenu>
                    </Rectangle.ContextMenu>
                </Rectangle>
                <!--"Image Preview" text-->
                <TextBlock x:Name="ImagePreviewTextBlock" Text="Preview" Grid.Row="2" Grid.RowSpan="2" Grid.Column="3" Foreground="White"
                       HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,315,0,0" FontSize="15" />
            </Grid>
            <!--The actual image previw control-->
            <Border Grid.Row="1" Grid.Column="3" Grid.RowSpan="4" x:Name="ImagePreviewBorder" Background="#000000" Visibility="Hidden"
                    Height="{Binding ActualHeight,ElementName=ImagePreviewBackground}" Width="{Binding ActualWidth,ElementName=ImagePreviewBackground}" HorizontalAlignment="Center" VerticalAlignment="Center"
                    PreviewDrop="Preview_PreviewDrop" ClipToBounds="True" AllowDrop="True">
                <Border.ContextMenu>
                    <ContextMenu Style="{StaticResource CustomMenu}">
                        <MenuItem Style="{StaticResource CustomMenuItem}" Header="Copy to Clipboard"
                                  Command="{Binding CopyImageToClipboardCommand}" />
                        <MenuItem Style="{StaticResource CustomMenuItem}" Header="Convert From Clipboard"
                                  Click="PasteFromClipboard" />
                        <MenuItem Style="{StaticResource CustomMenuItem}" Header="Reset Zoom &amp; Pan"
                                  Command="{Binding ResetZoomAndPanCommand}" />
                    </ContextMenu>
                </Border.ContextMenu>
                <Grid>
                    <Image HorizontalAlignment="Center" VerticalAlignment="Center" x:Name="ImagePreview" />
                    <StackPanel Grid.Row="1" Grid.Column="3" Grid.RowSpan="4" Orientation="Horizontal"
                                HorizontalAlignment="Center" VerticalAlignment="Center" x:Name="PreviewGrid"
                                PreviewDrop="Preview_PreviewDrop" AllowDrop="True"
                                Visibility="{Binding ShowPreviewGrid,Converter={StaticResource BooleanToVisibilityConverter}}" />
                </Grid>
            </Border>

            <!--Menu-->
            <ScrollViewer Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="2"
                          behaviors:ScrollAnimationBehavior.IsEnabled="True"
                          behaviors:ScrollAnimationBehavior.TimeDuration="00:00:00.10"
                          behaviors:ScrollAnimationBehavior.PointsToScroll="40" 
                          FocusVisualStyle="{x:Null}" Margin="0,5,-5,0" Padding="0,0,5,0"
                          VerticalScrollBarVisibility="Auto" CanContentScroll="True">
                <UniformGrid Columns="2">
                    <!-- column 1-->
                    <!--Cool buttons from Dopamine player-->
                    <StackPanel Width="145">
                        <views:BitDepthAndDitherSelector Margin="5" />
                        <views:ScaleModeSelector Margin="5" />
                        <views:ImageTransformControls Margin="5" />
                    </StackPanel>

                    <!--Column 2-->
                    <StackPanel Width="145">
                        <views:LCDSizeSelector Margin="5,5,5,5" />
                        <views:ImageSplitControls Margin="5" />
                    </StackPanel>
                </UniformGrid>
            </ScrollViewer>

            <Button Style="{StaticResource TransparentRoundedButton}" x:Name="BrowseFilesBtn"
                    Content="Browse Files" Grid.Row="4" Grid.Column="1" Margin="0,5,0,0" 
                    Width="145" Height="40" FontSize="15" VerticalAlignment="Top"
                    Command="{Binding BrowseFilesCommand}">
                <Button.ToolTip>
                    <ToolTip Style="{StaticResource CustomToolTip}" x:Name="BrowseFilesToolTip" Content="Browse local Files" FontSize="12" />
                </Button.ToolTip>
            </Button>

            <Button Style="{StaticResource TransparentRoundedButton}" x:Name="CopyToClipBtn"
                    Content="Copy to Clipboard" Grid.Row="4" Grid.Column="2" Margin="0,5,0,0"
                    Width="145" Height="40" FontSize="15" VerticalAlignment="Top"
                    Command="{Binding CopyImageToClipboardCommand}">
            </Button>
        </Grid>
    </DockPanel>
</Window>
